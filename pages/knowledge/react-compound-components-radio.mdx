import BlogLayout from '../../components/blog/blog-layout';
import { OuterLink } from '../../components/outer-link';
import { SnippetCard } from '../../components/snippets/snippet-card';
import { SnippetMetadata } from '../../lib/snippet-metadata';
import {DemoGeneric, DemoGuitar} from "../../components/demo/radio-demos";

export const meta = SnippetMetadata({
  title: 'Compound Components: RadioGroup',
  excerpt: 'RadioGroup example component implemented using compound components pattern',
  tags: ['react', 'typescript', 'pattern', 'snippet']
})

# Compound Components: RadioGroup

Compound components are very useful when you have a bunch of pieces that could be combined in different ways.

The radio group of items is an excellent example because is simpler to understand and can be combined in different forms.

For example, you could have the fallowing UI:

<DemoGuitar />

```jsx
export const DemoGuitar = () => (
  <Wrapper>
    <RadioGroup onSelect={console.log}>
      <h3 className="text-coolGray-700 text-lg mb-4">
        Choose your ultimate instrument
      </h3>

      <RadioGroup.Item id="acoustic_guitar">
        Acoustic Guitar
      </RadioGroup.Item>
      <RadioGroup.Item id="electric_guitar">
        Electric Guitar
      </RadioGroup.Item>
    </RadioGroup>
  </Wrapper>
)
```

Or something like this:

<DemoGeneric />

```jsx
export const DemoGeneric = () => (
  <Wrapper>
    <RadioGroup onSelect={console.log}>
      <h3 className="text-coolGray-700 text-lg mb-4">Choose your option</h3>

      <RadioGroup.Item id="one">
        <span className="text-red-600">Option one</span>
      </RadioGroup.Item>
      <RadioGroup.Item id="two">
        <span className="text-green-700">Option two</span>
      </RadioGroup.Item>
      <p className="text-coolGray-600 pt-2 pb-2">Some message</p>
      <RadioGroup.Item id="ultimate">
        <span className="text-purple-800 underline">
          Ultimate option
        </span>
      </RadioGroup.Item>
    </RadioGroup>
  </Wrapper>
)
```

## Code

```tsx
import { createContext, useContext, useEffect, useState } from 'react'

type RadioItemId = number | string

type RadioState = [RadioItemId, (selectedItem: RadioItemId) => void]

const RadioGroupContext = createContext<RadioState>(null)

export const RadioGroup = ({ children, onSelect }) => {
  const [selected, setSelected] = useState<RadioItemId>(undefined)

  useEffect(() => {
    onSelect(selected)
  }, [selected])

  return (
    <RadioGroupContext.Provider value={[selected, setSelected]}>
      {children}
    </RadioGroupContext.Provider>
  )
}

const Item = ({ id, children }) => {
  const [selected, setSelected] = useContext(RadioGroupContext)

  const handleSelect = () => setSelected(id)

  return (
    <label className="flex justify-start items-center">
      <input
        value={id}
        type="radio"
        checked={selected === id}
        onChange={handleSelect}
        className="mr-2"
      />
      {children}
    </label>
  )
}

RadioGroup.Item = Item
```

## Test file

```jsx
import { RadioGroup } from '../radio'
import { render, screen } from '@testing-library/react'
import userEvent from '@testing-library/user-event'

describe(RadioGroup.name, () => {
  const setup = ({ onSelect }) => {
    const items = [
      { id: '123', label: 'Item A' },
      { id: 'abc', label: 'Item B' },
      { id: '666', label: 'Item C' }
    ]

    render(
      <RadioGroup onSelect={onSelect}>
        {items.map((item) => (
          <RadioGroup.Item key={item.id} id={item.id}>
            {item.label}
          </RadioGroup.Item>
        ))}
      </RadioGroup>
    )

    return { items }
  }

  test('should render all items', () => {
    const onSelect = jest.fn()
    const { items } = setup({ onSelect })

    for (const item of items) {
      expect(screen.getByText(item.label)).toBeInTheDocument()
    }
  })

  test('should call the onSelect callback when click in item', () => {
    const onSelect = jest.fn()
    const { items } = setup({ onSelect })

    for (const item of items) {
      userEvent.click(screen.getByText(item.label))
      expect(onSelect).toBeCalledWith(item.id)
    }
  })
})
```

export default ({ children }) => <BlogLayout meta={meta}>{children}</BlogLayout>
